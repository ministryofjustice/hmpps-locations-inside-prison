{% from "govuk/components/table/macro.njk" import govukTable %}

{% from "../locationStatusTag.njk" import locationStatusTag %}

{% macro draftOther(locations) %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-full">
      {% set rows = [] %}
      {% for item in locations %}
        {% set rows = (rows.push(
          [
            { html: "<a href='/view-and-update-locations/" + item.prisonId + "/" + item.id + "'>" + (item.localName or item.pathHierarchy) + "</a>" },
            { html: locationStatusTag(item) },
            { text: '-' if item.numberOfCellLocations == 0 else (item.pendingChanges.certifiedNormalAccommodation or item.certification.certifiedNormalAccommodation) },
            { text: '-' if item.numberOfCellLocations == 0 else (item.pendingChanges.workingCapacity or item.capacity.workingCapacity) },
            { text: '-' if item.numberOfCellLocations == 0 else (item.pendingChanges.maxCapacity or item.capacity.maxCapacity) },
            { html: item.accommodationTypes | join('<br>') or '-' },
            { html: item.usedFor | join('<br>') or '-' }
          ]
        ), rows) %}
      {% endfor %}

      {{ govukTable({
        attributes: {
          "data-qa": "locations-table",
          "id": "locations-table"
        },
        firstCellIsHeader: true,
        head: [
          { text: "Location" },
          { text: "Status" },
          { text: "Baseline CNA" },
          { text: "Working capacity" },
          { text: "Maximum capacity" },
          { text: "Accommodation type" },
          { text: "Used for" }
        ],
        rows: rows
      }) }}
    </div>
  </div>
{% endmacro %}
